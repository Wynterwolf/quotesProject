<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Supernatural Quotes</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles/quote_style.css') }}"
    />

    <!-- Include Select2 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <h1>Supernatural Quotes</h1>

    {% if quote %}
    <h2>Random Quote</h2>
    <p><strong>Season:</strong> {{ quote['season'] }}</p>
    <p><strong>Episode:</strong> {{ quote['episode'] }}</p>
    <p><strong>Characters:</strong> {{ quote['characters'] }}</p>
    <p><strong>Quote:</strong> {{ quote['quote'] | safe }}</p>
    <!-- Use the safe filter here -->
    {% else %}
    <p>No quotes available.</p>
    {% endif %}

    <h2>Add a New Quote</h2>
    <form action="{{ url_for('add_quote') }}" method="POST">
      <!-- Season dropdown -->
      <label for="season">Season:</label>
      <select id="season" name="season" onchange="updateEpisodes()">
        <option value="Season 1">Season 1</option>
        <option value="Season 2">Season 2</option>
        <option value="Season 3">Season 3</option>
        <option value="Season 4">Season 4</option>
        <option value="Season 5">Season 5</option>
        <option value="Season 6">Season 6</option>
        <option value="Season 7">Season 7</option>
        <option value="Season 8">Season 8</option>
        <option value="Season 9">Season 9</option>
        <option value="Season 10">Season 10</option>
        <option value="Season 11">Season 11</option>
        <option value="Season 12">Season 12</option>
        <option value="Season 13">Season 13</option>
        <option value="Season 14">Season 14</option>
        <option value="Season 15">Season 15</option>
      </select>

      <!-- Episode input field -->
      <label for="episode">Episode:</label>
      <select id="episode" name="episode">
        <!-- Options will be dynamically populated based on the selected season -->
      </select>

      <!-- Characters dropdown with Select2 applied -->
      <label for="character">Character(s):</label>
      <select id="character" name="character" multiple>
        <option value="Dean Winchester">Dean Winchester</option>
        <option value="Sam Winchester">Sam Winchester</option>
        <option value="Castiel">Castiel</option>
        <option value="Bobby Singer">Bobby Singer</option>
        <!-- Add more characters as needed -->
      </select>

      <!-- Quote input field -->
      <label for="quote">Quote:</label>
      <textarea id="quote" name="quote" rows="4" cols="50"></textarea
      ><br /><br />

      <!-- Submit button -->
      <input type="submit" value="Add Quote" />
    </form>

    <!-- Include jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Include Select2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <script>
      $(document).ready(function () {
        $("#character").select2({
          placeholder: "Select one or more characters",
        });
      });
    </script>

    <!-- JavaScript to dynamically update episodes -->
    <script>
      const episodes = {
        "Season 1": [
          "1.01 Pilot",
          "1.02 Wendigo",
          "1.03 Dead in the Water",
          "1.04 Phantom Traveler",
          "1.05 Bloody Mary",
          "1.06 Skin",
          "1.07 Hook Man",
          "1.08 Bugs",
          "1.09 Home",
          "1.10 Asylum",
          "1.11 Scarecrow",
          "1.12 Faith",
          "1.13 Route 666",
          "1.14 Nightmare",
          "1.15 The Benders",
          "1.16 Shadow",
          "1.17 Hell House",
          "1.18 Something Wicked",
          "1.19 Provenance",
          "1.20 Dead Man's Blood",
          "1.21 Salvation",
          "1.22 Devil's Trap,",
        ],
        "Season 2": [
          "Episode 1",
          "Episode 2",
          "Episode 3" /* Add all episodes for Season 2 */,
        ],
        // Add more seasons and their corresponding episodes
      };

      function updateEpisodes() {
        const seasonSelect = document.getElementById("season");
        const episodeSelect = document.getElementById("episode");
        const selectedSeason = seasonSelect.value;

        // Clear current episode options
        episodeSelect.innerHTML = "";

        // Populate episodes based on the selected season
        episodes[selectedSeason].forEach(function (episode) {
          const option = document.createElement("option");
          option.value = episode;
          option.text = episode;
          episodeSelect.add(option);
        });
      }

      // Ensure episodes are loaded when the page loads
      window.onload = function () {
        updateEpisodes(); // Populate episodes on initial load
      };
    </script>
  </body>
</html>
